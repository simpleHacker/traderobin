== resource about strategies ==

=== financial blogs ===
* Flirting with Models	www.thinknewfound.com
* Mutiny Fund	mutinyfund.com/podcast/
* Chat with Traders	chatwithtraders.com
* Eran Raviv	eranraviv.com
* Sibyl/Godot Finance	godotfinance.com
* Party at the Moontower	moontowermeta.com
* My own!	epchan.blogspot.com

=== trader forums ===
* Elite Trader	www.Elitetrader.com
* Wealth-Lab	www.wealth-lab.com
Twitter	
* Benn Eifert	@bennpeifert
* Corey Hoffstein	@choffstein
* Quantocracy (retweet of new articles)	@Quantocracy
* Mike Harris	@mikeharrisNY
* Euan Sinclair	@sinclaireuan
* My own!	@chanep

== Strategies ==
* Pairs Trading

* Mean reversion:
 - Mean reversion of the spread of a pair of stocks, or a portfolio of stocks, back to its mean level is called cross-sectional mean reversion, and it happens much more often.
 - a mean-reverting strategy will buy on a fictitious quote that is much lower than some moving average and sell on the next correct quote that is in line with the moving average and thus makes a profit.
 - stionarity and cointegration: A time series is stationary if it never drifts farther and farther away from its initial value. In technical terms, stationary time series are “integrated of order zero,” or I(0) (Alexander, 2001). It is obvious that if the price series of a security is stationary, it would be a great candidate for a mean-reversion strategy. you can often find a pair of stocks such that if you long one and short the other, the market value of the pair is stationary. If this is the case, then the two individual time series are said to be cointegrated. They are so described because a linear combination of them is integrated of order zero. Typically, two stocks that form a cointegrating pair are from the same industry group. Traders have long been familiar with this so-called pair-trading strategy. They buy the pair portfolio when the spread of the stock prices formed by these pairs is low, and sell/short the pair when the spread is high—in other words, a classic mean-reverting strategy.
 - This example teaches you how to use a free MATLAB package, downloadable at www.spatial-econometrics.com, to determine if two price series are cointegrated and, if so, how to find the optimal hedge ratio (i.e., the number of shares of the second security versus one share of the first security).
 - The main method used to test for cointegration is called the cointegrating augmented Dickey-Fuller test, hence the function name cadf.

* Dollar neutral strategy.

* Market timing:

* social indicator: 

* Momentum can be generated by the slow diffusion of information
Essentially, this strategy recommends that you buy a stock when its earnings exceed expectations and short a stock when it falls short. More generally, many news announcements have the potential of altering expectations of a stock's future earnings, and therefore have the potential to trigger a trending period. As to what kind of news will trigger this, and how long the trending period will last, it is again up to you to find out.
 - Thus, a possibly erroneous decision by the first buyer is propagated as “information” to a herd of others. (Elon's twitter)

* Correlation between two price series actually refers to the correlations of their returns over some time horizon (for concreteness, let's say a day). If two stocks are positively correlated, there is a good chance that their prices will move in the same direction most days. However, having a positive correlation does not say anything about the long-term behavior of the two stocks. In particular, it doesn't guarantee that the stock prices will not grow farther and farther apart in the long run, even if they do move in the same direction most days. However, if two stocks were cointegrated and remain so in the future, their prices (weighted appropriately) will be unlikely to diverge.


== Factor Models ==
* attempts to capture the different drivers of returns such as earnings growth rates, interest rate, or the market capitalization of a company. These drivers are called factors
* excess returns (returns minus risk-free rate) R of N stocks as: R = Xb + u (where X is an N × F matrix of factor exposures (also known as factor loadings), b is an F vector of factor returns, and u an N vector of specific returns. (Every one of these quantities is time dependent)
* Factor exposures are the sensitivities of a stock to each of these common drivers.
* time-series factor model called the Fama-French Three-Factor model: This model postulates that the excess return of a stock depends linearly on only three factors:

The return of the market (the market factor).
The return of a hedge portfolio that longs small (based on market capitalization) stocks and shorts big stocks. This is the SMB, or small-minus-big, factor. - SMB factor measures whether the market favors small-cap stocks. 
The return of a hedge portfolio that longs high book-to-price-ratio (or “cheap”) stocks and shorts low book-to-price-ratio (or “expensive”) stocks. This is the HML, or high-minus-low, factor. - The HML factor measures whether the market favors value stocks

Whether the factor exposures you have chosen are sensible will determine whether the factor model explains the excess returns of the stocks adequately.

To find the factor exposures of a stock, run a linear regression of its historical returns against the Fama-French factors, as in Equation 7.1. (You can download the historical Fama-French factors from mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html.) Note this regression is contemporaneous, not predictive—you can't use these factor returns to predict a stock's next day's return, unless you can predict the next day's SMB and HML

== exiting model ==
entry signals are very specific to each trading strategy, exit signals are limited. They are based on one of these:

* A fixed holding period - For a mean-reverting strategy, however, there is a more statistically robust way to determine the optimal holding period that does not depend on the limited number of actual trades.
  Mathematicians tell us that the average value of z(t) follows an exponential decay to its mean μ, and the half-life of this exponential decay is equal to ln(2)/θ, which is the expected time it takes for the spread to revert to half its initial deviation from the mean. This half-life can be used to determine the optimal holding period for a mean-reverting position. Since we can make use of the entire time series to find the best estimate of θ, and not just on the days where a trade was triggered, the estimate for the half-life is much more robust than can be obtained directly from a trading model.
* A target price or profit cap -  And, indeed, it is much more reasonable to exit a position recommended by a mean-reversal model based on holding period or profit cap than stop loss
* The latest entry signals - Exiting this position now is almost akin to a stop loss. However, rather than imposing an arbitrary stop-loss price and thus introducing an extra adjustable parameter, which invites data-snooping bias, exiting based on the most recent entry signal is clearly justified based on the rationale for the momentum model
* A stop price

Stop loss can be suitable for momentum strategies but not reversal strategies.

=== belief ===
* What truly make a strategy proprietary and its secrets worth protecting are the tricks and variations that you have come up with, not the plain-vanilla version.

* In fact, quite the opposite—you should look for those strategies that fly under the radar of most institutional investors, for example, strategies that have very low capacities because they trade too often, strategies that trade very few stocks every day, or strategies that have very infrequent positions

* As a rule of thumb, I would not employ more than five parameters, including quantities such as entry and exit thresholds, holding period, or the lookback period, in computing moving averages.

* traders prefer to cut this recommended leverage in half for safety. This is called half-Kelly betting. It is always safer to have a leverage below what the Kelly formula recommends.

* My own observation is that when the movement of prices is due to news or other fundamental reasons (such as a company's deteriorating revenue), one is likely to be in a momentum regime, and one should not “stand in front"

* However, when securities prices move drastically without any apparent news or reasons, it is likely that the move is the result of a liquidity event—for example, major holders of the securities suddenly need to liquidate large positions for their own idiosyncratic reasons, or major speculators suddenly decide to cover their short positions. These liquidity events are of relatively short durations and mean reversion to the previous price levels is likely

* Unless you have a model for mean reversion that suggests now is a good time to enter into this position, this wait for mean reversion may very well lead to bigger losses instead.

=== knowledge ===
* future can use higher leverage.
* This notion has been shown to be mathematically false. In reality, maximum long-term growth is achieved by finding a strategy with the maximum Sharpe ratio (defined in the next section), provided that you have access to sufficiently high leverage
* python packages to use: There is Scikit-learn for machine learning, plotly for interactive data visualization, and seaborn for plotting, just to name a few most commonly used ones.
* market data: interactive brokers free when have a account, robin data
* For almost all daily stock data, the high and low prices are far noisier than the open and close prices. Hence, a backtest that relies on high and low data is less reliable than one that relies on the open and close.
* S&P 500 data: www.standardandpoors.com
* finiancial contagion. -- point to watch for selling
* high leverage vs high beta: you can increase return on a portfolio by either increasing its leverage or increasing its beta (by selecting high-beta stocks.) Both ways seem commonsensical. In fact, it is clear that given a low-beta portfolio and a high-beta portfolio, it is easy to apply a higher leverage on the low-beta portfolio so as to increase its beta to match that of the high-beta portfolio. And assuming that the stocks of two portfolios have the same average market capitalizations and book values, the average returns of the two will also be the same. So if the two hypothetical portfolios have the same average return, then we would prefer the one that has the smaller risk or standard deviation. Empirical studies have found that a portfolio that consists of low-beta stocks generally has lower risk and thus a higher Sharpe ratio. Hence, given a choice between a portfolio of high-beta stocks and a portfolio of low-beta stocks, we should prefer the low-beta ones, which we can then leverage up to achieve the maximum compounded growth rate.
=== strategies screening criteria ===
# How much time do you have for babysitting your trading programs?
# How good a programmer are you?
# How much capital do you have?
# Is your goal to earn steady monthly income or to strive for a large, long-term capital gain?
* filter out some unsuitable strategies if they fail one or more of these tests:
# Does it outperform a benchmark?
# Does it have a high enough Sharpe ratio?
# Does it have a small enough drawdown and short enough drawdown duration?
# Does the backtest suffer from survivorship bias?
# Does the strategy lose steam in recent years compared to its earlier years?
# Does the strategy have its own “niche” that protects it from intense competition from large institutional money managers?

== Testing measures ==
* Information ratio (sharp ratio - leverage return) is the measure to use when you want to assess a long-only strategy. It is defined as：
information ratio = (Average of excess returns) / (standard deviation of excess returns); 
Excess Returns = Portforlio Returns - Benchmark Returns
[Now the benchmark is usually the market index to which the securities you are trading belong. For example, if you trade only small-cap stocks, the market index should be the Standard & Poor's small-cap index or the Russell 2000 index, rather than the S&P 500. If you are trading just gold futures, then the market index should be gold spot price, rather than a stock index.]

* Sharp Ratio: As a rule of thumb, any strategy that has a Sharpe ratio of less than 1 is not suitable as a stand-alone strategy. For a strategy that achieves profitability almost every month, its (annualized) Sharpe ratio is typically greater than 2. For a strategy that is profitable almost every day, its Sharpe ratio is usually greater than 3.
** In general, if you calculate your average and standard deviation of returns based on a certain trading period T, whether T is a month, a day, or an hour, and you want to annualize these quantities, you have to first find out how many such trading periods there are in a year (call it NT). Then
 
For example, if your strategy holds positions only dur.
Annualized sharpe ratio = (Nt)(-1/2) * sharpe ratio rbased on t. (t )

** sharpe rate for a trading strategy (example): epchan.com/book/example3_4.ipynb
excess_return = (adj_close(t) - adj_close(t-1))/adj_close(t-1) - risk_free_rate/T; t within T
R = sqrt(T) * average(excess_return(1:T))/stdev(excess_return(1:T))
https://www.learnpythonwithrune.org/how-to-calculate-sharpe-ratio-with-pandas-and-numpy/


* drop down: You have to ask yourself, realistically, how deep and how long a drawdown will you be able to tolerate and not liquidate your portfolio and shut down your strategy? Would it be 20 percent and three months, or 10 percent and one month? Comparing your tolerance with the numbers obtained from the backtest of a candidate strategy determines whether that strategy is for you.

- max drop down: MDD = (lowest close - peak close) / peak close
- max dropdown duration: MAX(T(peak of one dropdown) - T(recover to the peak))

* MAR ratio: MAR ratio is just the ratio of the CAGR and the maximum drawdown, and it is somewhat independent of leverage.

* cointegration analysis:

* It also uses a function “ols” for linear regression, which is part of a free package downloaded from spatial-econometrics.com.)
== backtesting ==
* It is almost impossible to completely eliminate data-snooping bias as long as we are building data-driven models. However, there are ways to mitigate the bias:
 1. sample size. ensure that you have a sufficient amount of backtest data relative to the number of free parameters you want to optimize. If you want to be statistically confident (at the 95 percent level) that your true Sharpe ratio is equal to or greater than 0, you need a backtest Sharpe ratio of 1 and a sample size of 681 data points (e.g., 2.71 years of daily data).
The higher the backtest Sharpe ratio, the smaller the sample size is needed. If your backtest Sharpe ratio is 2 or more, then you need only 174 data points (0.69 years of daily data) to be confident that your true Sharpe ratio is equal to or greater than 0.
If you want to be confident that your true Sharpe ratio is equal to or greater than 1, then you need a backtest Sharpe ratio of at least 1.5 and a sample size of 2,739 (10.87 years of daily data).
2. Out-of-Sample Testing   Divide your historical data into two parts. Save the second (more recent) part of the data for out-of-sample testing. A much more intelligent way to optimize parameters than just using a moving lookback period parameter optimization or averaging over different parameter values is a novel technique we developed called Conditional Parameter Optimization (CPO). It makes use of machine learning to determine the optimal parameters to use for each trade or each day.
3. paper trading - real trading simulation.

4. In general, you should eliminate as many conditions, constraints, and parameters as possible as long as there is no significant decrease in performance in the test set, even though it may decrease performance on the training set.

^4. Conditional Parameter Optimization (CPO). It makes use of machine learning to determine the optimal parameters to use for each trade or each day

== Risk managment ==
The optimal allocation of capital and the optimal leverage to use so as to strike the right balance between risk management and maximum growth is the focus
* Kelly Formula:
 the portfolio has an annual mean excess return of 7.231 percent and an annual standard deviation of 16.91 percent, giving it a Sharpe ratio of 0.4275. The optimal leverage according to the Kelly formula is f = 0.07231/0.16912 = 2.528. 
The Kelly f is independent of time scale, so it actually does not matter whether you annualize your return and standard deviation, as opposed to the Sharpe ratio, which is time scale dependent

* maximum compounded growth rate: (S is none other than the sharpe ratio of your portfolio)
g=r+S*S/2

* compound growth rate with leverage: (return distribution of a strategy is Gaussian)
g(f) = r + fm - sqr(s)*sqr(f)/2
where f is the leverage; r is the risk-free rate; m is the average simple, uncompounded one-period excess return; and s is the standard deviation of those uncompounded returns. when f=1, no leverage 
 
* You might wonder what the Sharpe ratio and the maximum compounded growth rate generated using this optimal allocation are. It turns out that the maximum growth rate of a multistrategy Gaussian process is:
g(F*) = r + F*'CF*/2.  
Sharpe ratio: S = sqrt(F*'CF*). F*' is 


== model training ==
* Ideally, we would like trading parameters that are much more sensitive to the market conditions and yet are trained on a large enough amount of data.
* CPO use random forest with boosing: to learn from a large predictor (feature) set that captures various aspects of the prevailing market conditions, together with specific values of the trading parameters, to predict the outcome of the trading strategy.
* The set of parameters that results in the optimal predicted outcome (e.g., the highest future one-day return) will be selected as optimal, and will be adopted for the trading strategy for the next period.
* need to set some rules for trading, nut how to set these rules????
* In conventional, unconditional, parameter optimization, we select the three trading parameters (GDX_weight, entry threshold, and lookback) that maximize cumulative in-sample return over the three-dimensional parameter grid using exhaustive search.
* In addition to the three trading parameters, the predictors (or “features”) for input to our machine learning model are eight technical indicators obtained from the Technical Analysis Python library: Bollinger Bands Z-score, Money Flow, Force Index, Donchian Channel, Average True Range, Awesome Oscillator, and Average Directional Index. We choose these indicators to represent the market conditions. Each indicator actually produces 2 × 7 features

== trading platform ==
* interative broker
* robinhood.
